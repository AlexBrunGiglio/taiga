<app-admin-drawer>
    <div class="header-list">
        <div class="inline-item">
            <h1>Liste des utilisateurs</h1>
            <button class="icon-btn" (click)="refreshData()">
                <i class="fa-solid fa-arrows-rotate"></i>
            </button>
        </div>
        <div>
            <tui-input icon="tuiIconUser" iconAlign="right" [(ngModel)]="request.search"
                (ngModelChange)="loadDataDelayed();" [disabled]="loading" name="searchUser">
                Rechercher un utilisateur
            </tui-input>
        </div>
    </div>
    <div style="overflow-y: auto;">
        <tui-loader [overlay]="true" [showLoader]="loading">
            <table *ngIf="usersList && !loading" class="table">
                <thead>
                    <tr>
                        <th>
                            <div class="checkbox-row">
                                <tui-checkbox [(ngModel)]="selectAll" (ngModelChange)="onSelectAllItem()"
                                    [ngModelOptions]="{standalone:true}">
                                </tui-checkbox>
                                <p class="checkbox-title">Tout sélectionner</p>
                            </div>
                        </th>
                        <th style="width: 50px;">
                            #
                        </th>
                        <th *ngFor="let col of columns">
                            {{col | titlecase}}
                        </th>
                        <th>
                            Actions
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of usersList;let i=index">
                        <td>
                            <tui-checkbox [(ngModel)]="item.selected" [ngModelOptions]="{standalone:true}">
                            </tui-checkbox>
                        </td>
                        <td style="width: 50px;" (click)="item.selected=!item.selected">
                            {{i}}
                        </td>
                        <td (click)="item.selected=!item.selected">
                            {{item.user.lastname | uppercase }}
                        </td>
                        <td (click)="item.selected=!item.selected">
                            {{item.user.firstname | titlecase}}
                        </td>
                        <td (click)="item.selected=!item.selected">
                            {{item.user.mail}}
                        </td>
                        <td (click)="item.selected=!item.selected">
                            {{item.user.phone}}
                        </td>
                        <td (click)="item.selected=!item.selected">
                            <ng-container *ngFor="let role of item.user.roles">
                                <tui-tag *ngIf="role.label === RolesList.Visitor" size="m" status="primary"
                                    [value]="role.label! | titlecase"></tui-tag>
                                <tui-tag *ngIf="role.label === RolesList.Admin" size="m" status="success"
                                    [value]="role.label! | titlecase"></tui-tag>
                            </ng-container>
                        </td>
                        <td (click)="item.selected=!item.selected">
                            <ng-container *ngIf="item.user.disabled">Archivé</ng-container>
                            <ng-container *ngIf="!item.user.disabled">Actif</ng-container>
                        </td>
                        <td>
                            <button tuiIconButton appearance="flat" size="s" icon="tuiIconEdit" title="Modifier"
                                shape="rounded" class="edit"
                                [routerLink]="['/' + RoutesList.AdminUsers + '/' + item.user.id]"></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </tui-loader>
    </div>
    <div class="table-action-row">
        <button class="button-s" tuiButton [routerLink]="['/' + RoutesList.AdminUsers + '/new']" type="button"
            appearance="primary" icon="tuiIconPlus">
            Ajouter
        </button>
        <button (click)="remove()" class="button-s" tuiButton type="button" appearance="accent" icon="tuiIconTrash">
            Supprimer
        </button>
    </div>
</app-admin-drawer>